(function(){var f,d,p,h,b,g,n,m,j,e,a,o,i=[].slice,q=[].indexOf||function(t){for(var s=0,r=this.length;s<r;s++){if(s in this&&this[s]===t){return s}}return -1},l={}.hasOwnProperty,c=function(u,s){for(var r in s){if(l.call(s,r)){u[r]=s[r]}}function t(){this.constructor=u}t.prototype=s.prototype;u.prototype=new t();u.__super__=s.prototype;return u},k=function(r,s){return function(){return r.apply(s,arguments)}};p={bind:function(v,x){var u,s,t,w,r;s=v.split(" ");u=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={});for(w=0,r=s.length;w<r;w++){t=s[w];u[t]||(u[t]=[]);u[t].push(x)}return this},one:function(r,s){return this.bind(r,function(){this.unbind(r,arguments.callee);return s.apply(this,arguments)})},trigger:function(){var s,x,t,w,v,r,u;s=1<=arguments.length?i.call(arguments,0):[];t=s.shift();w=this.hasOwnProperty("_callbacks")&&((u=this._callbacks)!=null?u[t]:void 0);if(!w){return}for(v=0,r=w.length;v<r;v++){x=w[v];if(x.apply(this,s)===false){break}}return true},unbind:function(u,y){var r,t,x,w,s,v;if(!u){this._callbacks={};return this}x=(v=this._callbacks)!=null?v[u]:void 0;if(!x){return this}if(!y){delete this._callbacks[u];return this}for(t=w=0,s=x.length;w<s;t=++w){r=x[t];if(!(r===y)){continue}x=x.slice();x.splice(t,1);this._callbacks[u]=x;break}return this}};h={trace:true,logPrefix:"(App)",log:function(){var r;r=1<=arguments.length?i.call(arguments,0):[];if(!this.trace){return}if(this.logPrefix){r.unshift(this.logPrefix)}if(typeof console!=="undefined"&&console!==null){if(typeof console.log==="function"){console.log.apply(console,r)}}return this},error:function(){var r;r=1<=arguments.length?i.call(arguments,0):[];if(this.logPrefix){r.unshift(this.logPrefix)}if(typeof console!=="undefined"&&console!==null){if(typeof console.error==="function"){console.error.apply(console,r)}}return this},dir:function(){var r;r=1<=arguments.length?i.call(arguments,0):[];if(typeof console!=="undefined"&&console!==null){if(typeof console.dir==="function"){console.dir.apply(console,r)}}return this}};o=["included","extended"];g=(function(){r.include=function(v){var s,u,t;if(!v){throw new Error("include(obj) requires obj")}for(s in v){u=v[s];if(q.call(o,s)<0){this.prototype[s]=u}}if((t=v.included)!=null){t.apply(this)}return this};r.extend=function(v){var s,u,t;if(!v){throw new Error("extend(obj) requires obj")}for(s in v){u=v[s];if(q.call(o,s)<0){this[s]=u}}if((t=v.extended)!=null){t.apply(this)}return this};r.proxy=function(s){var t=this;return function(){return s.apply(t,arguments)}};r.prototype.proxy=function(s){var t=this;return function(){return s.apply(t,arguments)}};function r(){if(typeof this.init==="function"){this.init.apply(this,arguments)}}return r})();b=(function(r){c(s,r);s.extend(p);s.records={};s.crecords={};s.attributes=[];s.configure=function(){var t,u;u=arguments[0],t=2<=arguments.length?i.call(arguments,1):[];this.className=u;this.records={};this.crecords={};if(t.length){this.attributes=t}this.attributes&&(this.attributes=a(this.attributes));this.attributes||(this.attributes=[]);this.unbind();return this};s.toString=function(){return""+this.className+"("+(this.attributes.join(", "))+")"};s.find=function(u){var t;t=this.records[u];if(!t&&(""+u).match(/c-\d+/)){return this.findCID(u)}if(!t){throw new Error("Unknown record")}return t.clone()};s.findCID=function(u){var t;t=this.crecords[u];if(!t){throw new Error("Unknown record")}return t.clone()};s.exists=function(u){try{return this.find(u)}catch(t){return false}};s.refresh=function(w,x){var u,v,y,t;if(x==null){x={}}if(x.clear){this.records={};this.crecords={}}v=this.fromJSON(w);if(!j(v)){v=[v]}for(y=0,t=v.length;y<t;y++){u=v[y];u.id||(u.id=u.cid);this.records[u.id]=u;this.crecords[u.cid]=u}this.trigger("refresh",this.cloneArray(v));return this};s.select=function(w){var v,u,t;t=(function(){var y,x;y=this.records;x=[];for(v in y){u=y[v];if(w(u)){x.push(u)}}return x}).call(this);return this.cloneArray(t)};s.findByAttribute=function(u,w){var x,t,v;v=this.records;for(x in v){t=v[x];if(t[u]===w){return t.clone()}}return null};s.findAllByAttribute=function(t,u){return this.select(function(v){return v[t]===u})};s.each=function(x){var u,w,v,t;v=this.records;t=[];for(u in v){w=v[u];t.push(x(w.clone()))}return t};s.all=function(){return this.cloneArray(this.recordsValues())};s.first=function(){var t;t=this.recordsValues()[0];return t!=null?t.clone():void 0};s.last=function(){var t,u;u=this.recordsValues();t=u[u.length-1];return t!=null?t.clone():void 0};s.count=function(){return this.recordsValues().length};s.deleteAll=function(){var u,w,v,t;v=this.records;t=[];for(u in v){w=v[u];t.push(delete this.records[u])}return t};s.destroyAll=function(){var u,w,v,t;v=this.records;t=[];for(u in v){w=v[u];t.push(this.records[u].destroy())}return t};s.update=function(v,u,t){return this.find(v).updateAttributes(u,t)};s.create=function(v,u){var t;t=new this(v);return t.save(u)};s.destroy=function(u,t){return this.find(u).destroy(t)};s.change=function(t){if(typeof t==="function"){return this.bind("change",t)}else{return this.trigger("change",t)}};s.fetch=function(t){if(typeof t==="function"){return this.bind("fetch",t)}else{return this.trigger("fetch",t)}};s.toJSON=function(){return this.recordsValues()};s.fromJSON=function(x){var w,v,u,t;if(!x){return}if(typeof x==="string"){x=JSON.parse(x)}if(j(x)){t=[];for(v=0,u=x.length;v<u;v++){w=x[v];t.push(new this(w))}return t}else{return new this(x)}};s.fromForm=function(){var t;return(t=new this).fromForm.apply(t,arguments)};s.recordsValues=function(){var u,t,w,v;t=[];v=this.records;for(u in v){w=v[u];t.push(w)}return t};s.cloneArray=function(x){var w,v,u,t;t=[];for(v=0,u=x.length;v<u;v++){w=x[v];t.push(w.clone())}return t};s.idCounter=0;s.uid=function(u){var t;if(u==null){u=""}t=u+this.idCounter++;if(this.exists(t)){t=this.uid(u)}return t};function s(t){s.__super__.constructor.apply(this,arguments);if(t){this.load(t)}this.cid=this.constructor.uid("c-")}s.prototype.isNew=function(){return !this.exists()};s.prototype.isValid=function(){return !this.validate()};s.prototype.validate=function(){};s.prototype.load=function(v){var t,u;for(t in v){u=v[t];if(typeof this[t]==="function"){this[t](u)}else{this[t]=u}}return this};s.prototype.attributes=function(){var v,t,x,u,w;t={};w=this.constructor.attributes;for(x=0,u=w.length;x<u;x++){v=w[x];if(v in this){if(typeof this[v]==="function"){t[v]=this[v]()}else{t[v]=this[v]}}}if(this.id){t.id=this.id}return t};s.prototype.eql=function(t){return !!(t&&t.constructor===this.constructor&&(t.cid===this.cid)||(t.id&&t.id===this.id))};s.prototype.save=function(v){var u,t;if(v==null){v={}}if(v.validate!==false){u=this.validate();if(u){this.trigger("error",u);return false}}this.trigger("beforeSave",v);t=this.isNew()?this.create(v):this.update(v);this.trigger("save",v);return t};s.prototype.updateAttribute=function(u,v,t){this[u]=v;return this.save(t)};s.prototype.updateAttributes=function(u,t){this.load(u);return this.save(t)};s.prototype.changeID=function(u){var t;t=this.constructor.records;t[u]=t[this.id];delete t[this.id];this.id=u;return this.save()};s.prototype.destroy=function(t){if(t==null){t={}}this.trigger("beforeDestroy",t);delete this.constructor.records[this.id];delete this.constructor.crecords[this.cid];this.destroyed=true;this.trigger("destroy",t);this.trigger("change","destroy",t);this.unbind();return this};s.prototype.dup=function(u){var t;t=new this.constructor(this.attributes());if(u===false){t.cid=this.cid}else{delete t.id}return t};s.prototype.clone=function(){return m(this)};s.prototype.reload=function(){var t;if(this.isNew()){return this}t=this.constructor.find(this.id);this.load(t.attributes());return t};s.prototype.toJSON=function(){return this.attributes()};s.prototype.toString=function(){return"<"+this.constructor.className+" ("+(JSON.stringify(this))+")>"};s.prototype.fromForm=function(w){var v,t,y,u,x;t={};x=f(w).serializeArray();for(y=0,u=x.length;y<u;y++){v=x[y];t[v.name]=v.value}return this.load(t)};s.prototype.exists=function(){return this.id&&this.id in this.constructor.records};s.prototype.update=function(u){var v,t;this.trigger("beforeUpdate",u);t=this.constructor.records;t[this.id].load(this.attributes());v=t[this.id].clone();v.trigger("update",u);v.trigger("change","update",u);return v};s.prototype.create=function(u){var v,t;this.trigger("beforeCreate",u);if(!this.id){this.id=this.cid}t=this.dup(false);this.constructor.records[this.id]=t;this.constructor.crecords[this.cid]=t;v=t.clone();v.trigger("create",u);v.trigger("change","create",u);return v};s.prototype.bind=function(v,x){var t,u,w=this;this.constructor.bind(v,t=function(y){if(y&&w.eql(y)){return x.apply(w,arguments)}});this.constructor.bind("unbind",u=function(y){if(y&&w.eql(y)){w.constructor.unbind(v,t);return w.constructor.unbind("unbind",u)}});return t};s.prototype.one=function(u,w){var t,v=this;return t=this.bind(u,function(){v.constructor.unbind(u,t);return w.apply(v,arguments)})};s.prototype.trigger=function(){var t,u;t=1<=arguments.length?i.call(arguments,0):[];t.splice(1,0,this);return(u=this.constructor).trigger.apply(u,t)};s.prototype.unbind=function(){return this.trigger("unbind")};return s})(g);d=(function(r){c(s,r);s.include(p);s.include(h);s.prototype.eventSplitter=/^(\S+)\s*(.*)$/;s.prototype.tag="div";function s(t){this.release=k(this.release,this);var u,w,v;this.options=t;v=this.options;for(u in v){w=v[u];this[u]=w}if(!this.el){this.el=document.createElement(this.tag)}this.el=f(this.el);this.$el=this.el;if(this.className){this.el.addClass(this.className)}if(this.attributes){this.el.attr(this.attributes)}if(!this.events){this.events=this.constructor.events}if(!this.elements){this.elements=this.constructor.elements}if(this.events){this.delegateEvents(this.events)}if(this.elements){this.refreshElements()}s.__super__.constructor.apply(this,arguments)}s.prototype.release=function(){this.trigger("release");this.el.remove();return this.unbind()};s.prototype.$=function(t){return f(t,this.el)};s.prototype.delegateEvents=function(y){var v,x,w,A,t,u,z=this;u=[];for(x in y){A=y[x];if(typeof A==="function"){A=(function(B){return function(){B.apply(z,arguments);return true}})(A)}else{if(!this[A]){throw new Error(""+A+" doesn't exist")}A=(function(B){return function(){z[B].apply(z,arguments);return true}})(A)}w=x.match(this.eventSplitter);v=w[1];t=w[2];if(t===""){u.push(this.el.bind(v,A))}else{u.push(this.el.delegate(t,v,A))}}return u};s.prototype.refreshElements=function(){var u,w,v,t;v=this.elements;t=[];for(u in v){w=v[u];t.push(this[w]=this.$(u))}return t};s.prototype.delay=function(t,u){return setTimeout(this.proxy(t),u||0)};s.prototype.html=function(t){this.el.html(t.el||t);this.refreshElements();return this.el};s.prototype.append=function(){var v,u,t;u=1<=arguments.length?i.call(arguments,0):[];u=(function(){var y,x,w;w=[];for(y=0,x=u.length;y<x;y++){v=u[y];w.push(v.el||v)}return w})();(t=this.el).append.apply(t,u);this.refreshElements();return this.el};s.prototype.appendTo=function(t){this.el.appendTo(t.el||t);this.refreshElements();return this.el};s.prototype.prepend=function(){var v,u,t;u=1<=arguments.length?i.call(arguments,0):[];u=(function(){var y,x,w;w=[];for(y=0,x=u.length;y<x;y++){v=u[y];w.push(v.el||v)}return w})();(t=this.el).prepend.apply(t,u);this.refreshElements();return this.el};s.prototype.replace=function(t){var u,v;v=[this.el,f(t.el||t)],u=v[0],this.el=v[1];u.replaceWith(this.el);this.delegateEvents(this.events);this.refreshElements();return this.el};return s})(g);f=(typeof window!=="undefined"&&window!==null?window.jQuery:void 0)||(typeof window!=="undefined"&&window!==null?window.Zepto:void 0)||function(r){return r};m=Object.create||function(s){var r;r=function(){};r.prototype=s;return new r()};j=function(r){return Object.prototype.toString.call(r)==="[object Array]"};e=function(s){var r;if(!s){return true}for(r in s){return false}return true};a=function(r){return Array.prototype.slice.call(r,0)};n=this.Spine={};if(typeof module!=="undefined"&&module!==null){module.exports=n}n.version="1.0.8";n.isArray=j;n.isBlank=e;n.$=f;n.Events=p;n.Log=h;n.Module=g;n.Controller=d;n.Model=b;g.extend.call(n,p);g.create=g.sub=d.create=d.sub=b.sub=function(s,t){var r;r=(function(v){c(u,v);function u(){return u.__super__.constructor.apply(this,arguments)}return u})(this);if(s){r.include(s)}if(t){r.extend(t)}if(typeof r.unbind==="function"){r.unbind()}return r};b.setup=function(t,s){var r;if(s==null){s=[]}r=(function(v){c(u,v);function u(){return u.__super__.constructor.apply(this,arguments)}return u})(this);r.configure.apply(r,[t].concat(i.call(s)));return r};n.Class=g}).call(this);