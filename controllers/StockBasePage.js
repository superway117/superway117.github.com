(function(){var e,c,b=function(f,g){return function(){return f.apply(g,arguments)}},a={}.hasOwnProperty,d=function(i,g){for(var f in g){if(a.call(g,f)){i[f]=g[f]}}function h(){this.constructor=i}h.prototype=g.prototype;i.prototype=new h();i.__super__=g.prototype;return i};e=Spine.$;c=(function(g){d(f,g);f.prototype.tmplId="pageTmpl";f.prototype.elements={"div[data-role=header] form input[type=text]":"searchText"};f.prototype.events={"submit div[data-role=header] form":"deFetchStock","focus div[data-role=header] form input[type=text]":"deClearSearch","click div[data-role=header] a.brand":"deGoHome"};function f(){this.updateQuickBar=b(this.updateQuickBar,this);this.meSettingRefresh=b(this.meSettingRefresh,this);this.searchTypeAhead=b(this.searchTypeAhead,this);f.__super__.constructor.apply(this,arguments);Stock.FavList.bind("refresh",this.meSettingRefresh);Stock.FavList.bind("update",this.updateQuickBar);Stock.FavList.fetch();this.searchText.typeahead({source:this.searchTypeAhead,matcher:function(){return true}})}f.prototype.searchTypeAhead=function(n,k){var j,m,l,i,h;m=Stock.StockDict.query(n);h=[];for(l=0,i=m.length;l<i;l++){j=m[l];h.push(j.join(","))}return h};f.prototype.meSettingRefresh=function(){var i,k,h,j;if(Stock.FavList.count()===0){j=Stock.FavList["default"];for(k=0,h=j.length;k<h;k++){i=j[k];Stock.FavList.create(i)}}return this.updateQuickBar()};f.prototype.updateQuickBar=function(){var k,m,j,h,i,l=this;this.clearQuickBar();i=Stock.FavList.all();for(j=0,h=i.length;j<h;j++){m=i[j];m=m.attributes();k={name:m.stock,text:m.firstLetter};this.appendQuickBar(k)}e("a",this.quickBar).click(function(n){return l.deQuickBarClick(n)});return e("a",this.quickBar).dblclick(function(n){m=e(n.target).attr("name");return Stock.Util.openStockInputModal(l,function(p){var o;o=Stock.FavList.findByAttribute("stock",m);o.stock=p.slice(0,6);o.firstLetter=p.slice(7,9);return o.save()})})};f.prototype.deClearSearch=function(h){return e(h.target).val("")};return f})(Stock.Page);window.Stock.StockBasePage=c}).call(this);