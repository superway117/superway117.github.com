(function(){var e,a,c=function(f,g){return function(){return f.apply(g,arguments)}},b={}.hasOwnProperty,d=function(i,g){for(var f in g){if(b.call(g,f)){i[f]=g[f]}}function h(){this.constructor=i}h.prototype=g.prototype;i.prototype=new h();i.__super__=g.prototype;return i};e=Spine.$;a=(function(g){d(f,g);f.include(Spine.Events);f.prototype.debug=false;f.prototype.urlBase=null;f.techParams={size:{command:"z",values:{large:"l",middle:"m"}},type:{command:"q",values:{line:"l",candle:"c",bar:"b"}},scale:{command:"1",values:{"log ":"on",linear:"off"}},range:{command:"t",values:{"1d":"1d","5d":"5d","1m":"1m","3m":"3m","6m":"6m","1y":"1y","2y":"2y","5y":"5y",max:"my"}},indicator:{command:"a",values:{roc:"p12",macd:"m26-12-9",mfi:"f14",ss:"ss",rsi:"r14",fs:"fs",vol:"v",volma:"vm",wr:"w14"}},compare:{command:"c"}};f.fetchTodayChart=function(j,h){var i;if(j==null){j="000001.SS"}if(h==null){h="b"}j=this.canonical(j);i=Math.random();return"http://ichart.yahoo.com/"+h+"?s="+j+"&dummy="+i};f.fetchSmallChart=function(h){if(h==null){h="000001.SS"}return this.fetchTodayChart(h,"t")};f.fetchLargeChart=function(h){if(h==null){h="000001.SS"}return this.fetchTodayChart(h,"b")};f.fetchTechChart=function(p,x){var m,i,w,n,u,q,j,l,h,t,s,o,r;if(p==null){p="000001.SS"}p=this.canonical(p);h="http://chart.finance.yahoo.com/z?s="+p+"&lang=en-US&region=US";if(!x){return h}if(x.compare){i="";if(e.isArray(x.compare)){q=((function(){var z,v,y,k;y=x.compare;k=[];for(n=z=0,v=y.length;z<v;n=++z){t=y[n];k.push(this.canonical(t))}return k}).call(this)).join(",");h+="&"+this.techParams.compare.command+"="+q}else{h+="&"+this.techParams.compare.command+"="+(this.canonical(x.compare))}}delete x.compare;for(m in x){l=x[m];if(w=this.techParams[m]){h+="&"+w.command+"=";q=l.split(",");for(o=0,r=q.length;o<r;o++){j=q[o];if(s=w.values[j]){u=h.charAt(h.length-1);if(u===","||u==="="){h+=s}else{h+=","+s}}}}}return h};f.canonical=function(h){if(h.lastIndexOf(".")===-1){if(h.charAt(0)==="6"){return h+=".SS"}else{return h+=".SZ"}}return h};function f(){this.fetchLastCallback=c(this.fetchLastCallback,this);this.fetchQuotesCallback=c(this.fetchQuotesCallback,this);this.fetchHistoryCallback=c(this.fetchHistoryCallback,this);f.__super__.constructor.apply(this,arguments);this.bind("fetchHistory",this.fetchHistoryImpl);this.bind("fetchQuotes",this.fetchQuotesImpl);this.bind("fetchLast",this.fetchLastImpl);if(this.debug){this.urlBase="http://127.0.0.1:8080/stock?api="}else{this.urlBase="http://107.22.188.63:8080/stock?api="}}f.prototype.fetchHistory=function(h){return this.trigger("fetchHistory",h)};f.prototype.fetchHistoryImpl=function(i){var k,h,j=this;k=f.canonical(i.stockID);h=""+this.urlBase+"gethistory&callback=?&s="+k+"&a="+i.startM+"&b="+i.startD+"&c="+i.startY;if(i.endY){h+="&d="+i.endM+"&e="+i.endD+"&f="+i.endY}return e.getJSON(h,function(l){return j.fetchHistoryCallback(l)})};f.prototype.fetchHistoryCallback=function(h){return this.trigger("fetchHistoryFinished",h)};f.prototype.fetchQuotes=function(h){return this.trigger("fetchQuotes",h)};f.prototype.fetchQuotesImpl=function(i){var j,m,k,h,l=this;j=(function(){var p,o,n;n=[];for(p=0,o=i.length;p<o;p++){m=i[p];n.push(this.constructor.canonical(m))}return n}).call(this);k=j.join("+");h=""+this.urlBase+"getquotes&callback=?&s="+k;return e.getJSON(h,function(n){return l.fetchQuotesCallback(n)})};f.prototype.fetchQuotesCallback=function(h){return this.trigger("fetchQuotesFinished",h)};f.prototype.fetchLast=function(h){return this.trigger("fetchLast",h)};f.prototype.fetchLastImpl=function(i){var j,m,k,h,l=this;j=(function(){var p,o,n;n=[];for(p=0,o=i.length;p<o;p++){m=i[p];n.push(this.constructor.canonical(m))}return n}).call(this);k=j.join("+");h=""+this.urlBase+"getlast&callback=?&s="+k;return e.getJSON(h,function(n){return l.fetchLastCallback(n)})};f.prototype.fetchLastCallback=function(h){return this.trigger("fetchLastFinished",h)};return f})(Spine.Module);window.Stock.YahooStock=a}).call(this);