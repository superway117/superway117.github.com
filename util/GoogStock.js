(function(){var e,d,b=function(f,g){return function(){return f.apply(g,arguments)}},a={}.hasOwnProperty,c=function(i,g){for(var f in g){if(a.call(g,f)){i[f]=g[f]}}function h(){this.constructor=i}h.prototype=g.prototype;i.prototype=new h();i.__super__=g.prototype;return i};e=Spine.$;d=(function(g){c(f,g);f.include(Spine.Events);function f(){this.fetchHistoryCallback=b(this.fetchHistoryCallback,this);this.fetchStockCallback=b(this.fetchStockCallback,this);this.bind("fetchStock",this.fetchCNStockImpl)}f.prototype.fetchStock=function(h){return this.trigger("fetchStock",h)};f.prototype.fetchCNStockImpl=function(j){var h,i=this;if(j==null){j="SHA:000001"}j=this.canonical(j);h="http://www.google.cn/finance/info?q="+j+"&infotype=infoquoteall&oe=gb2312&callback=?";return e.getJSON(h,function(k){return i.fetchStockCallback(k)})};f.prototype.canonical=function(k){var j,i,h;if(k.length<6){return}j=k.slice(0,6);if(k.lastIndexOf(".")!==-1&&k.length===9){h=k.slice(7,9).toLowerCase();if(h==="ss"){i="SHA:"}else{i="SHE:"}}else{if(k.charAt(0)==="6"){i="SHA:"}else{i="SHE:"}}return""+i+j};f.prototype.fetchStockCallback=function(i){var h;h={};h.status="fail";if(i.length>0){h.status="succ";h.list=i}return this.trigger("fetchFinished",h)};f.prototype.fetchHistoryCallback=function(h){return this.trigger("fetchHistoryFinished",h.result)};return f})(Spine.Module);window.Stock.GoogStock=d}).call(this);